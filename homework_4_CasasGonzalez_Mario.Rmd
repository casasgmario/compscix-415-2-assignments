---
title: "COMPSCIX 415.2 Homework 4"
author: "Mario Casas Gonzalez"
date: "July 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

My Github repository for my assignments can be found at this URL: https://github.com/casasgmario/compscix-415-2-assignments 

```{r load_packages, warning=FALSE, message=FALSE, echo = FALSE}
library(mdsr)
library(tidyverse)
library(nycflights13)

```
## Section 5.6.7: #2, #4 and #6 only. Extra Credit: Do #5

### Exercise #2 Come up with another approach that will give you the same output as not_cancelled %>% count(dest) and not_cancelled %>% count(tailnum, wt = distance) (without using count()).



```{r 5.6.7-2, warning=FALSE, message=FALSE, echo = FALSE}

not_cancelled <- flights %>% filter(!is.na(dep_delay), !is.na(arr_delay))
not_cancelled %>% group_by(dest) %>% summarise(n = sum(!is.na(dep_time)))
not_cancelled %>% group_by(tailnum) %>% summarise(n = sum(distance))


```


### Exercise #4 Look at the number of cancelled flights per day. Is there a pattern? Is the proportion of cancelled flights related to the average delay?

As shown in the plots below, cancellations tend to peak around the beginning of the second weekd of the month. The higher the number of cancellations, the lower the average delay. 


```{r 5.6.7-4, warning=FALSE, message=FALSE, echo = FALSE}

cancelled <- flights %>% filter(is.na(dep_time))

cancelled_by_day <- flights %>% group_by(day) %>% summarize(cancelled=sum(is.na(dep_time)),avg_delay=(mean(!is.na(dep_delay))))

ggplot(data=cancelled_by_day, mapping=aes(x=day,y=cancelled)) +geom_point() +geom_smooth()

ggplot(data=cancelled_by_day, mapping=aes(x=day,y=cancelled, size=avg_delay)) +geom_point() +geom_smooth()


```


### Exercise #6 What does the sort argument to count() do. When might you use it?


```{r 5.6.7-6, warning=FALSE, message=FALSE, echo = FALSE}

cancelled %>% count (day,sort=TRUE)

```

