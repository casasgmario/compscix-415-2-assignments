---
title: "COMPSCIX 415.2 Homework 6"
author: "Mario Casas Gonzalez"
date: "July 16, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mosaicData)

```

##Exercise 1

###1. What variables are in this data set?

According to the help file, the variables are the following:

- outcome | survival status after 20 years: a factor with levels Alive Dead

- smoker | smoking status at baseline: a factor with levels No Yes

- age | age (in years) at the time of the first survey

###2. How many observations are there and what does each represent?

Ther are 1314 observation on women, representing their age during the first survey, smoking status and survival status after 20 years. 


###3. Create a table (use the R code below as a guide) and a visualization of the relationship between smoking status and outcome, ignoring age. What do you see? Does it make sense?

It doesn't make sense because it seems to show more smokers survive. 

```{r Exercise1.3, echo=TRUE}
smoking_outcome <- Whickham %>% count(smoker,outcome)
smoking_outcome <- smoking_outcome %>% spread (key=outcome,value=n)
ggplot(Whickham,aes(smoker))+geom_bar(mapping=aes(fill=outcome), position="fill")
```

###4. Recode the age variable into an ordered factor with three categories: age <= 44, age > 44 & age <= 64, and age > 64. Now, recreate visualization from above, but facet on your new age factor. What do you see? Does it make sense?

```{r Exercise1.4, echo=TRUE}
age_fact <- factor(Whickham$age,ordered=TRUE)
age_fact <- factor(levels=c('young','middle_age','old'))
age_fact <- case_when(Whickham$age<=44 ~'young', Whickham$age>44 & Whickham$age<=64 ~ 'middle_age', Whickham$age>64 ~'senior')
age_fact <- fct_relevel(age_fact, 'young','middle_age','senior')
Whickham_cat <- Whickham %>% mutate(age_fact)
Whickham_cat %>% count(age_fact, smoker, outcome)
ggplot(Whickham_cat,aes(smoker))+geom_bar(mapping=aes(fill=outcome), position="fill") + facet_grid(~age_fact)

```


